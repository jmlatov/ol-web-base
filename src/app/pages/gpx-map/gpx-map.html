<div class='track-selector-container'>
  <p><label>
      <strong>Selecciona Track: </strong>

      <select (change)="onTrackSelect($event)" class="track-selector">
        @for (track of gpxTracks; track track.path) {
        <option [value]="track.path">{{ track.name }}</option>
        } @empty {
        <option disabled>No tracks found</option>
        }
      </select>
    </label>

    <label>
      <strong> Tipo de Mapa: </strong>
      <select (change)="onBaseLayerChange($event)" class='track-selector'>
        <option value="osm">Mapa de calles (OSM)</option>
        <option value="satellite">Sat칠lite (Esri)</option>
      </select>
    </label>
  </p>
</div>


<div class="map-wrapper">
  <div id="map" class="map">


    <!-- Leyenda colapsable -->
    <div #legendRef class="ol-legend ol-unselectable ol-control">
      <button class="legend-toggle" (click)="toggleLegend()" [attr.aria-expanded]="legendExpanded">
        {{ legendExpanded ? '游댷 Leyenda' : '郊윒잺 Leyenda' }}
      </button>
      <div class="legend-content" [class.collapsed]="!legendExpanded">
        <h4>Pendiente del Track</h4>
        <p>La pendiente se calcula como la diferencia de altitud entre el inicio y el final del tramo, expresada como un
          porcentaje.</p>
        <div class="legend-colors">
          <span class="color-decrease"></span>
          <span class="color-neutral"></span>
          <span class="color-increase"></span>
        </div>
        <div class="legend-labels">
          <span>Descenso</span>
          <span>Plano</span>
          <span>Ascenso</span>
        </div>
        <div class="legend-gradient"></div>
        <div class="legend-labels">
          <span>-20%</span>
          <span>0%</span>
          <span>+20%</span>
        </div>
      </div>

      <div id="legend-box" class="ol-attribution-bottom-right"></div>




    </div>

    <!-- Panel de datos din치micos -->
    <div class="info-panel ol-unselectable ol-control">
      <h4>Informaci칩n en el punto del cursor</h4>
      <div>Elevaci칩n: {{ info.elevation }} m</div>
      <div>Pendiente: {{ info.slope }} %</div>
      <!-- <div>Distancia total: {{ info.totalDistance }} km</div> -->
      <div>Recorrido: {{ info.travelled }} km</div>
      <div>Restante: {{ info.remaining }} km</div>
    </div>

    <!-- Popup del mapa -->
    <div id="popup" class="ol-popup">
      <a href="#" id="popup-closer" class="ol-popup-closer"></a>
      <div id="popup-content"></div>
    </div>

  </div>

  <!-- 游녢 Gr치fico de perfil de elevaci칩n debajo del mapa -->
  <div class="elevation-container">
    <canvas #elevationCanvas id="elevation-chart"></canvas>
  </div>
</div>